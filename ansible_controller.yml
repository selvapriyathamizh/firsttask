- name: connect to ansible controlle
  hosts: localhost
  roles:
    - {role: infra.controller_configuration.credential_types, when: controller_credential_types is defined}
  vars:
    controller_hostname: "https://52.73.124.144"
    controller_username: "admin"
    controller_oauthtoken: "Fooym5yPjS8tKQULR61PCK9abNLtGk"
    controller_validate_certs: false
    controller_credential_types:
      - name: API controller cli file
        description: API controller cli file
        state: present
        inputs:
          fields:
            - id: tower_cli_api_url
              type: string 
              label: tower_cli_api_url
            - id: tower_cli_api_token
              type: string 
              label: tower_cli API Toke
          required: 
            -  tower_cli_api_url
            -  tower_cli_api_token
        injectors: 
          file: 
            template: "[general]\nhost = !unsafe \" {{ tower_cli_api_url }} \"\nverify_ssl = false\noauth_token = !unsafe \"{{ tower_cli_api_token }}\""
          extra_vars:
            TOWER_CLI_CFG_FILE: "{{ tower.filename }}"
            tower_cli_api_token: "{{ tower_cli_api_token }}"
           
  tasks:

    - debug: var=controller_credential_types
    - name: connect to ansible controller
      ansible.builtin.uri: 
        url: https://52.73.124.144/api/v2/
        headers: 
          Content-Type: application/json
          Authorization: "Bearer Fooym5yPjS8tKQULR61PCK9abNLtGk"
        validate_certs: false

    
